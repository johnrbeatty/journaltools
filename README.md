# journaltools
Tools for prepping, extracting metadata, and manipulating scanned journals in PDF files.

journaltools is a Python 3 toolkit for extracting metadata from journal volumes, issues or articles in PDF files. It was originally developed to process early volumes of the Buffalo Law Review before uploading to the University at Buffalo School of Law Digital Commons repository. It offers a number of command-line programs to extract and export metadata, split large PDF files into smaller files, combine a number of PDF files into one file, and shift pages in number of consecutively-paginated files.

Someday, perhaps, I will have time to properly document everything here. For now, here is a quick roundup of what everything does. I hope the code comments are enough to help anyone familiar with Python to be able to use these with minimal recoding. Essentially all of the metadata scanning and extraction files should be used as a starting point for whatever PDF files the user has. Find the closest equivalent and tweak the included files to work with your source. Most of the command-line programs have debug options that will help in tweaking the code. For ones with a debug range of 1-6, 1-4 will give more output at higher numbers (generally 2 will output all the metadata pieces that the code finds, and 4 will also show original text), 4 and 5 will dump the complete text in the PDF to be processed, 6 will output the contents of all records that will be passed back to the csv export function. 

FILES:

journaltools.py: Contains most of the code for the command-line files. In general, the command-line files only take in options and one or more filenames from the user to pass to functions here.

dsplit-XX.py: The dsplit files contain the metadata extraction routines. They are intended to be used on full issues. Each of these contains custom search code for the type of PDF it was intended to be used on. All routines at a minimum look for the start and ending pages of each article in the PDF and the title. They may also look for a printed page number and one or more authors. Metadata will be exported to a csv file.
-	rd (recent decisions): Looks for the start and end of pieces that have a title, then the main text, and then the author’s name. Also looks for starting and ending page numbers. The end page is where the author’s name appears. 
-	coa-new (Court of Appeals): Looks for the start and end of pieces that have a title, then the main text, and then may or may not have an author’s name. It also looks for page numbers. The end page is where the next article starts, so will be incorrect for pieces that end the page before the next article starts.
-	coa (Court of Appeals early volumes): Looks through the table of contents that opens the early Court of Appeals sections to get titles and authors of the main sections, and then goes through the full text looking for the start and end pages.
-	br (Book Reviews): This is basically the same as rd, but rd looks for titles in all caps. 

pdfsplit.py: This uses an exported csv file from a dsplit routine to split the corresponding PDF. The user supplies the PDF and csv and the code looks at the starting and ending pages in the csv entries and creates a series of files from the original PDF that contain those page ranges.

dc-convert.py: This will take a dsplit-created csv file and output the fields to an Excel file that can be cut and pasted into a Digital Commons series upload spreadsheet. It will take as an argument the filename of a Digital Commons series upload spreadsheet and find the appropriate output columns. That file has to be converted to xlsx format to be read by dc-convert. 

combine-pdf.py: Used to combine a number of sequential files (named in the same style as Hein-provided files) into one file. I used it to recombine volume indexes that were split into multiple files back into one index file. 

page-shift.py: This takes user input of two filenames. It will copy the first page of the second file to the end of the first file. It is used to add the final page to an article that was cut off because the next article started on its final page. 

dir-shift.py: This will take a directory as an argument and look through it for sequences of Hein-provided files, then feed them into the page shift code to copy all of the first pages to the previous last page. 

mdgen-blr.py: Similar to dsplit, but intended for single articles. It also looks for more metadata including volume number, issue, and month and year of publication. It can be used on a single article or, more usefully, in a bash script to scan all several files from a single issue to write to a single csv file.

mdconv-blr.py: A version of dc-convert.py for the files generated by mdgen-blr.py that converts a csv to an Excel file for cutting and pasting into a Digital Commons series upload spreadsheet.

prep-ublf.py: This is used to prep magazines that were scanned as full sheets. It goes through a file and crops everything to 8.5” x 11”. 

mdconv-ublf.py: A version of dc-convert.py for the hand-edited csv files I build for processing the UB Law Forum, our alumni magazine.

FIELD NAMES:

The code here uses a set of standardized field names for the csv files it generates, and also standard Digital Commons field names for Excel export:

Internal:

title: Article title

section: Section title. Only used in -ublf code.

start_page: First page of the article (printed page number)

start_pdf_page: First page of the article in the PDF (zero-indexed)

end_pdf_page: Last page of the article in the PDF (zero-indexed)

f_name: Author’s first name

m_name: Author’s middle initial or name

l_name: Author’s last name

suffix: Suffix to author’s name, if any

volume: Volume number of journal (only mdgen-blr & mdconv-blr)

issue: Journal issue number (only mdgen-blr & mdconv-blr)

month: Month of issue (only mdgen-blr & mdconv-blr)

year: Year of journal volume (only mdgen-blr & mdconv-blr)

document_type: Digital Commons document type (only mdgen-blr & mdconv-blr)

f_nameX: Author X’s first name (X=1 to 4) (only mdgen-blr & mdconv-blr)

m_nameX: Author X’s middle name (only mdgen-blr & mdconv-blr)

l_nameX: Author X’s last name (only mdgen-blr & mdconv-blr)

suffix: Suffix for Author X’s name, if any (only mdgen-blr & mdconv-blr)


Digital Commons:

title: Article title

fpage: First page of article (printed page)

authorX_fname: Author X’s first name (X=1 to 4)

authorX_mname: Author X’s middle name

authorX_lname: Author X’s last name

authorX_suffix: Suffix for Author X’s name, if any

authorX_is_corporate: Flag for corporate authors (no last name)
